<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Glyph Assessment</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
    }
    .container {
      max-width: 600px;
      margin: 2rem auto;
      background: #fff;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h2 {
      margin-top: 0;
    }
    .step {
      display: none;
    }
    .step.active {
      display: block;
    }
    .field-group {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-direction: column;
    }
    @media (min-width: 480px) {
      .field-group {
        flex-direction: row;
      }
    }
    input[type="text"] {
      padding: 0.5rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      width: 100%;
    }
    button {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      background-color: #4f46e5;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 1rem;
    }
    button:hover {
      background-color: #4338ca;
    }
    .question {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 0.75rem;
      margin: 0.5rem 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .controls {
      display: flex;
      flex-direction: row;
      gap: 0.3rem;
    }
    .arrow-btn {
      background: #eee;
      border: none;
      font-size: 1.2rem;
      padding: 0.3rem 0.6rem;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">

    <!-- Step: Name -->
    <section id="step-name" class="step active">
      <h2>Enter Your Name</h2>
      <div class="field-group">
        <input id="firstName" type="text" placeholder="First Name" />
        <input id="lastName" type="text" placeholder="Last Name" />
      </div>
      <button id="nameContinue">Continue</button>
    </section>

    <!-- Step: Rank -->
    <section id="step-rank" class="step">
      <h2>Rank the Questions</h2>
      <p>Use the arrows to move the questions. Easiest should be on top.</p>
      <div id="rankList"></div>
      <button id="rankContinue">Next</button>
    </section>

    <!-- Step: Confidence -->
    <section id="step-confidence" class="step">
      <h2>Rate Your Confidence</h2>
      <p>(This section will contain your confidence rating logic...)</p>
      <button onclick="showStep('complete')">Next</button>
    </section>

    <!-- Step: Complete -->
    <section id="step-complete" class="step">
      <h2>Done!</h2>
      <p>Thanks for completing the assessment.</p>
    </section>

  </div>

  <script>
    const showStep = (step) => {
      document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
      document.getElementById(`step-${step}`).classList.add('active');
      localStorage.setItem('current_step', step);
    };

    document.getElementById('nameContinue').addEventListener('click', () => {
      const first = document.getElementById('firstName').value.trim();
      const last = document.getElementById('lastName').value.trim();
      if (!first || !last) {
        alert('Please enter both first and last names.');
        return;
      }
      localStorage.setItem('student_name', JSON.stringify({ first, last }));
      showStep('rank');
    });

    // Ranking logic
    const questions = [
      { id: 'q_easy', label: 'Simplify 3y + 5y - 2.' },
      { id: 'q_basic', label: 'Evaluate m² - 12 ÷ m, when m = 4.' },
      { id: 'q_moderate', label: 'You earn $35 per hour tutoring. You already have $540 in your savings. Write an expression for your total money after h hours.' },
      { id: 'q_challenging', label: 'Simplify 4x − 2(3x − 1) + 5.' },
      { id: 'q_advanced', label: 'Write 4(a − 2) with no multiplication.' }
    ];

    let currentOrder = [...questions].sort(() => Math.random() - 0.5);

    function renderRankList() {
      const list = document.getElementById("rankList");
      list.innerHTML = "";

      currentOrder.forEach((q, index) => {
        const div = document.createElement("div");
        div.className = "question";

        const label = document.createElement("div");
        label.innerHTML = `<strong>${index + 1}.</strong> ${q.label}`;

        const controls = document.createElement("div");
        controls.className = "controls";

        const up = document.createElement("button");
        up.className = "arrow-btn";
        up.textContent = "▲";
        up.disabled = index === 0;
        up.onclick = () => move(index, index - 1);

        const down = document.createElement("button");
        down.className = "arrow-btn";
        down.textContent = "▼";
        down.disabled = index === currentOrder.length - 1;
        down.onclick = () => move(index, index + 1);

        controls.appendChild(up);
        controls.appendChild(down);

        div.appendChild(label);
        div.appendChild(controls);
        list.appendChild(div);
      });
    }

    function move(from, to) {
      const item = currentOrder.splice(from, 1)[0];
      currentOrder.splice(to, 0, item);
      renderRankList();
    }

    document.getElementById('rankContinue').addEventListener('click', () => {
      localStorage.setItem('orderedQuestions', JSON.stringify(currentOrder));
      showStep('confidence');
    });

    // Restore last step if refreshed
    const savedStep = localStorage.getItem('current_step');
    if (savedStep && document.getElementById(`step-${savedStep}`)) {
      showStep(savedStep);
    }

    // Render if on rank step
    if (savedStep === 'rank' || !savedStep) {
      renderRankList();
    }
  </script>
</body>
</html>
